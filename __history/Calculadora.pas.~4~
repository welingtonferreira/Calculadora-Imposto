unit Calculadora;

interface

uses
  SysUtils, Vcl.Dialogs;

type
  TOperacao = (tpNenhuma, tpSoma, tpSubtracao, tpMultiplicacao, tpDivisao, tpZeraCalculadora, tpImpostoA, tpImpostoB, tpImpostoC);

  TCalculadora = class
  private
    FResultado: Double;
  public
    constructor Create;
    function Somar(const ValorA, ValorB: Double): Double;
    function Multiplicar(const ValorA, ValorB: Double): Double;
    function Subtrair(const ValorA, ValorB: Double): Double;
    function Dividir(const ValorA, ValorB: Double): Double;
  end;

  TImpostoCalc = class (TCalculadora)
  public
    function GetImpostoA(const aBaseCalculo: Double): Double;
    function GetImpostoB(const aBaseCalculo: Double): Double;
    function GetImpostoC(const aBaseCalculo: Double): Double;
  end;

  TCalculadoraController = class
  private
    FCalculadora : TImpostoCalc;
  public
    constructor Create;
    destructor Destroy; override;
    function ExecutaOperacao(const aOperacao: TOperacao; const aValorA, aValorB: Double): Double;
  end;

implementation

{ TCalculadora }

constructor TCalculadora.Create;
begin
  try
    Self.FResultado := 0;
  except
    on E: Exception do
    begin
      ShowMessage('TCalculadora.Create' + #13 + E.Message);
    end;
  end;
end;

function TCalculadora.Dividir(const ValorA, ValorB: double): double;
begin
  try
    Result := ValorA / ValorB;
  except
    on E: Exception do
    begin
      ShowMessage('TCalculadora.Dividir' + #13 + E.Message);
    end;
  end;
end;

function TCalculadora.Multiplicar(const ValorA, ValorB: double): double;
begin
  try
    Result := ValorA * ValorB;
  except
    on E: Exception do
    begin
      ShowMessage('TCalculadora.Multiplicar' + #13 + E.Message);
    end;
  end;
end;

function TCalculadora.Somar(const ValorA, ValorB: double): double;
begin
  try
    Result := ValorA + ValorB;
  except
    on E: Exception do
    begin
      ShowMessage('TCalculadora.Somar' + #13 + E.Message);
    end;
  end;
end;

function TCalculadora.Subtrair(const ValorA, ValorB: double): double;
begin
  try
    Result := ValorA - ValorB;
  except
    on E: Exception do
    begin
      ShowMessage('TCalculadora.Subtrair' + #13 + E.Message);
    end;
  end;
end;

{ TCalculadoraController }

constructor TCalculadoraController.Create;
begin
  try
    FCalculadora := TImpostoCalc.Create;
  except
    on E: Exception do
    begin
      ShowMessage('TCalculadoraController.Create' + #13 + E.Message);
    end;
  end;
end;

destructor TCalculadoraController.Destroy;
begin
  try
    FCalculadora.Free;
    inherited;
  except
    on E: Exception do
    begin
      ShowMessage('TCalculadoraController.Destroy' + #13 + E.Message);
    end;
  end;
end;

function TCalculadoraController.ExecutaOperacao(
  const aOperacao: TOperacao; const aValorA, aValorB: double): double;
begin
  try
    case aOperacao of
      tpSoma: Result := Self.FCalculadora.Somar(aValorA, aValorB);
      tpSubtracao: Result := Self.FCalculadora.Subtrair(aValorA, aValorB);
      tpMultiplicacao: Result := Self.FCalculadora.Multiplicar(aValorA, aValorB);
      tpDivisao: Result := Self.FCalculadora.Dividir(aValorA, aValorB);
      tpImpostoA: Result := Self.FCalculadora.GetImpostoA(aValorA);
      tpImpostoB: Result := Self.FCalculadora.GetImpostoB(aValorA);
      tpImpostoC: Result := Self.FCalculadora.GetImpostoC(aValorA);
    end;
  except
    on E: Exception do
    begin
      ShowMessage('TCalculadoraController.ExecutaOperacao' + #13 + E.Message);
    end;
  end;
end;

{ TImpostoCalc }

function TImpostoCalc.GetImpostoA(const aBaseCalculo: Double): Double;
var
  vPercentual: Double;
begin
  try
    vPercentual := 20 / 100;
    Result := (aBaseCalculo * vPercentual) - 500;
  except
    on E: Exception do
    begin
      ShowMessage('TImpostoCalc.GetImpostoA' + #13 + E.Message);
    end;
  end;
end;

function TImpostoCalc.GetImpostoB(const aBaseCalculo: double): double;
begin
  try
    Result := Self.GetImpostoA(aBaseCalculo) - 15;
  except
    on E: Exception do
    begin
      ShowMessage('TImpostoCalc.GetImpostoB' + #13 + E.Message);
    end;
  end;
end;

function TImpostoCalc.GetImpostoC(const aBaseCalculo: double): double;
begin
  try
    Result := Self.GetImpostoA(aBaseCalculo) + Self.GetImpostoB(aBaseCalculo);
  except
    on E: Exception do
    begin
      ShowMessage('TImpostoCalc.GetImpostoC' + #13 + E.Message);
    end;
  end;
end;

end.
